# ===== ЛОВУШКА 1: macOS Big Sur =====
create macos-device
set macos-device personality "Apple Mac OS 8.1"
set macos-device default udp action reset
set macos-device default tcp action reset
set macos-device default icmp action open

# Открытые TCP порты (SSH, VNC, HTTP, HTTPS, Bonjour, AFP)
add macos-device tcp port 22 "/usr/share/honeyd/scripts/openssh.sh"
add macos-device tcp port 25 "/usr/share/honeyd/scripts/smtp.sh"
add macos-device tcp port 80 "/usr/share/honeyd/scripts/http.sh"
add macos-device tcp port 110 "/usr/share/honeyd/scripts/pop3.sh"
add macos-device tcp port 143 "/usr/share/honeyd/scripts/imap.sh"
add macos-device tcp port 427 open
add macos-device tcp port 445 open
add macos-device tcp port 548 open
add macos-device tcp port 5900 open
add macos-device tcp port 5988 open

# Открытые UDP порты (DNS, DHCP, Bonjour, NTP)
add macos-device udp port 53 open
add macos-device udp port 67 open
add macos-device udp port 68 open
add macos-device udp port 123 open
add macos-device udp port 137 open
add macos-device udp port 138 open
add macos-device udp port 161 open
add macos-device udp port 5353 open

# Закрытые порты (для улучшения отпечатка ОС)
add macos-device tcp port 1 closed
add macos-device tcp port 21 closed
add macos-device tcp port 23 closed
add macos-device tcp port 3389 closed
add macos-device tcp port 8080 closed
add macos-device udp port 514 closed

set macos-device ethernet "10:10:10:10:10:10"
set macos-device uptime 8642340

bind 172.16.238.10 macos-device

# ===== ЛОВУШКА 2: Linux Server =====
create linux-server
set linux-server personality "Linux 2.2.14"
# set linux-server personality "Apple Mac OS 8.1"
set linux-server default udp action reset
set linux-server default tcp action reset
set linux-server default icmp action open

# Стандартные Linux сервисы
add linux-server tcp port 22 "/usr/share/honeyd/scripts/openssh.sh"
add linux-server tcp port 23 "/usr/share/honeyd/scripts/telnet.sh"
add linux-server tcp port 25 "/usr/share/honeyd/scripts/smtp.sh"
add linux-server tcp port 53 "/usr/share/honeyd/scripts/dns.sh"
add linux-server tcp port 80 "/usr/share/honeyd/scripts/http.sh"
add linux-server tcp port 111 "/usr/share/honeyd/scripts/portmap.sh"
add linux-server tcp port 139 open
add linux-server tcp port 143 "/usr/share/honeyd/scripts/imap.sh"
add linux-server tcp port 445 open
add linux-server tcp port 587 open
add linux-server tcp port 993 open
add linux-server tcp port 995 open
add linux-server tcp port 3306 open
add linux-server tcp port 5432 open

# UDP сервисы
add linux-server udp port 53 open
add linux-server udp port 111 open
add linux-server udp port 137 open
add linux-server udp port 138 open
add linux-server udp port 161 open
add linux-server udp port 162 open

# Закрытые порты
add linux-server tcp port 1 closed
add linux-server tcp port 465 closed
add linux-server tcp port 8443 closed
add linux-server udp port 500 closed

set linux-server ethernet "14:14:14:14:14:14"
set linux-server uptime 12964800

bind 172.16.238.11 linux-server

# ===== ЛОВУШКА 3: Network Device (Cisco Router) =====
create network-device
set network-device personality "Cisco 1601R router running IOS 12.1(5)"
set network-device default udp action reset
set network-device default tcp action reset
set network-device default icmp action open

# Управление маршрутизатором
add network-device tcp port 23 "/usr/share/honeyd/scripts/telnet.sh"
add network-device tcp port 80 "/usr/share/honeyd/scripts/http.sh"
add network-device tcp port 443 open
add network-device tcp port 22 "/usr/share/honeyd/scripts/openssh.sh"

# Сетевые сервисы
add network-device udp port 53 open
add network-device udp port 67 open
add network-device udp port 69 open
add network-device udp port 161 open
add network-device udp port 162 open
add network-device udp port 520 open

# Закрытые порты
add network-device tcp port 1 closed
add network-device tcp port 21 closed
add network-device tcp port 25 closed

set network-device ethernet "12:12:12:12:12:12"
set network-device uptime 45289600

bind 172.16.238.12 network-device
