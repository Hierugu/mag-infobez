<ossec_config>
  <!-- Основные глобальные настройки -->
  <global>
    <jsonout_output>yes</jsonout_output> <!-- Включение JSON вывода для API -->
    <alerts_log>yes</alerts_log> <!-- Ведение лога алертов -->
    <logall>no</logall> <!-- Не логировать все события (рекомендуется no) -->
    <logall_json>no</logall_json> <!-- Не логировать все события в JSON -->
    <!-- Белые списки IP-адресов для управления -->
    <white_list>127.0.0.1</white_list>
    <white_list>::1</white_list>
    <white_list>192.168.1.0/24</white_list> <!-- Пример сети для агентов -->
  </global>

  <!-- Настройки для удаленного получения событий (syslog, etc.) -->
  <!-- ВНИМАНИЕ: В Wazuh 4.x+ используется блок <integration> вместо <remote> -->
  <integration>
    <name>syslog</name>
    <hook_url>syslog://</hook_url>
    <level>5</level>
    <api_auth>
      <username>wazuh</username>
      <password>YourStrongPassword</password>
    </api_auth>
  </integration>

  <!-- Настройки алертов -->
  <alerts>
    <log_alert_level>3</log_alert_level> <!-- Уровень для логирования (1-16) -->
    <email_alert_level>12</email_alert_level> <!-- Уровень для email-уведомлений -->
  </alerts>

  <!-- Настройки логирования -->
  <logging>
    <log_format>default</log_format> <!-- Рекомендуется default вместо json -->
  </logging>

  <!-- Настройки правил и декодеров -->
  <ruleset>
    <!-- Директории по умолчанию -->
    <decoder_dir>ruleset/decoders</decoder_dir>
    <rule_dir>ruleset/rules</rule_dir>
    <rule_exclude>0215-policy_rules.xml</rule_exclude> <!-- Пример исключения правил -->

    <!-- Базовые декодеры (порядок важен!) -->
    <decoder>ruleset/decoders/local_decoder.xml</decoder>
    <decoder>ruleset/decoders/0000-json_decoders.xml</decoder>
    <decoder>ruleset/decoders/0005-wazuh_decoders.xml</decoder>
    <decoder>ruleset/decoders/0010-aws_decoders.xml</decoder>
    
    <!-- Базовые правила (порядок важен!) -->
    <rule>ruleset/rules/0010-rules_config.xml</rule>
    <rule>ruleset/rules/0020-syslog_rules.xml</rule>
    <rule>ruleset/rules/0025-ossec_rules.xml</rule>
    <rule>ruleset/rules/0040-auth_rules.xml</rule>
    <rule>ruleset/rules/0500-syslog_rules.xml</rule>
    <rule>ruleset/rules/0510-ti_rule.xml</rule>
    
    <!-- Пользовательские правила (если есть) -->
    <rule>ruleset/rules/local_rules.xml</rule>
    
    <!-- Списки (CDB списки) -->
    <list>etc/lists/audit-keys</list>
    <list>etc/lists/security-eventchannel</list>
  </ruleset>

  <!-- Настройки для получения логов по syslog (альтернативный способ) -->
  <localfile>
    <location>/var/ossec/logs/archives/archives.json</location>
    <log_format>json</log_format>
  </localfile>

  <!-- Настройки мониторинга в реальном времени (пример) -->
  <syscheck>
    <disabled>no</disabled>
    <frequency>43200</frequency>
    <scan_on_start>yes</scan_on_start>
    
    <directories check_all="yes" realtime="yes">/etc,/usr/bin,/usr/sbin</directories>
    <directories check_all="yes" realtime="yes">/bin,/sbin,/boot</directories>
    
    <ignore>/etc/mtab</ignore>
    <ignore>/etc/hosts.deny</ignore>
  </syscheck>

  <!-- Настройки сканирования уязвимостей -->
  <vulnerability-detection>
    <enabled>yes</enabled>
    <index-status>yes</index-status>
    <feed-update-interval>60m</feed-update-interval>
  </vulnerability-detection>

</ossec_config>